## 理解I/O与零拷贝技术

### 什么是I/O？

I/O就是简单的数据Copy，仅此而已！

这一点很重要！

既然是copy数据，那么又是从哪里copy到哪里呢？

如果数据是从外部设备copy到内存中，这就是Input。

如果数据是从内存copy到外部设备，这就是Output。

内存与外部设备之间不嫌麻烦的来回copy数据就是Input and Output，简称I/O（Input/Output），仅此而已。

### I/O与CPU

CPU执行机器指令的速度是纳秒级别的，而通常的I/O比如磁盘操作，一次磁盘seek大概在毫秒级别，因此如果我们把CPU的速度比作战斗机的话，那么I/O操作的速度就是肯德鸡

### 执行I/O时底层都发生了什么

与CPU执行指令的速度相比，I/O操作操作是非常慢的，因此操作系统是不可能把宝贵的CPU计算资源浪费在无谓的等待上的，这时重点来了，注意接下来是重点哦。

由于外部设备执行I/O操作是相当慢的，因此在I/O操作完成之前进程是无法继续向前推进的，这就是所谓的阻塞，即通常所说的block。

操作系统检测到进程向I/O设备发起请求后就暂停进程的运行，怎么暂停运行呢？很简单：只需要记录下当前进程的运行状态并把CPU的PC寄存器指向其它进程的指令就可以了。

进程有暂停就会有继续执行，因此操作系统必须保存被暂停的进程以备后续继续执行，显然我们可以用队列来保存被暂停执行的进程。

### 零拷贝（Zero-copy）

上面的讲解中我们直接把磁盘数据copy到了进程空间中，但实际上一般情况下I/O数据是要首先copy到操作系统内部，然后操作系统再copy到进程空间中。

